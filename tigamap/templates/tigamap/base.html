{% load leaflet_tags %}
{% load staticfiles %}
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
	<title>Tigatrapp Map</title>

    {% leaflet_js %}
    {% leaflet_css %}
    <script src="{% static "tigamap/tigamap_scripts.js" %}"></script>


  <!-- Begin Cookie Consent plugin by Silktide - http://silktide.com/cookieconsent -->
<link rel="stylesheet" type="text/css" href="http://assets.cookieconsent.silktide.com/current/style.min.css"/>
<script type="text/javascript" src="http://assets.cookieconsent.silktide.com/current/plugin.min.js"></script>
<script type="text/javascript">
// <![CDATA[
cc.initialise({
	cookies: {},
	settings: {
		consenttype: "implicit"
	}
});
// ]]>
</script>
<!-- End Cookie Consent plugin -->

  {% block head_additions %}


   {% endblock %}


  <style>
       .leaflet-container {  /* all maps */
            width:  100%;
            height: 100%;
       }


    </style>

  {% block leaflet_code %}


   {% endblock %}

  </head>
  <body>


    {%  block main_body %}

    {% endblock %}

<div id="tigamap" class="leaflet-container-default"></div>
<script type="text/javascript">
(function () {

    function loadmap() {

				var centerLat = loadSavedLat();
				var centerLng = loadSavedLng();
				var initialZoom = loadSavedZoom();

				if (isNaN(centerLat) || isNaN(centerLng)) {
					centerLat = 40.0000;
					centerLng = -4.0000;
				}

				if (isNaN(initialZoom)) {
					initialZoom = 6;
				}


        var djoptions = {"layers": [["OSM", "http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
                    "\u00a9 <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors"]],
                    "minimap": false, "scale": "metric", "center": [centerLat, centerLng], "tilesextent": [],
                    "attributionprefix": null, "zoom": initialZoom, "maxzoom": 18, "minzoom": 0, "extent": [[-90,
                        -180], [90,
                        180]], "resetview": true, "srid": null, "fitextent": true},
            options = {djoptions: djoptions, initfunc: loadmap,
                       globals: false, callback: window.map_init_basic};
        L.Map.djangoMap('tigamap', options);
    }
    var loadevents = ["load"];
    if (loadevents.length === 0) loadmap();
    else if (window.addEventListener) for (var i=0; i<loadevents.length; i++) window.addEventListener(loadevents[i], loadmap, false);
    else if (window.jQuery) jQuery(window).on(loadevents.join(' '), loadmap);

})();
</script>


    {% block logo %}


    {% endblock %}

      {% block end_body %}


    {% endblock %}

  </body>
</html>