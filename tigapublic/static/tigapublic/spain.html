<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="author" content="@sigte_udg" />
    <title>Mosquito Alert</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<link href="http://www.mosquitoalert.com/wp-content/themes/enfold-child/images/favicons/favicon.ico" rel="shortcut icon">

    <link href="lib/bootstrap-3.3.6/css/bootstrap.min.css" rel="stylesheet">
    <link href="lib/bootstrap-select-1.10.0/dist/css/bootstrap-select.min.css" rel="stylesheet">
    <link href="lib/leaflet/dist/leaflet.css" rel="stylesheet">


    <link href="lib/Leaflet.markercluster-leaflet-0.7/dist/MarkerCluster.css" rel="stylesheet">
	<link href="lib/Leaflet.markercluster-leaflet-0.7/dist/MarkerCluster.Default.css" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="lib/jssocials-1.2.1/jssocials.css">
    <link rel="stylesheet" type="text/css" href="lib/jssocials-1.2.1/jssocials-theme-flat.css">

    <!-- build:css css/style.min.css -->
    <link href="css/style.css" rel="stylesheet">
    <link href="css/map.css" rel="stylesheet">
    <!-- endbuild -->
	<!--Font awesome-->
	<link href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">

</head>
<body>
<div id="page-map" class="page">
    <div id="header-view">
      <nav class="navbar navbar-default">
        <div class="container-fluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <div class="logo" i18n="header.logo_url|onclick"></div>
            <div class="header-separator"></div>
            <div class="motto" i18n="header.motto"></div>
            <div class="share-site-buttons"></div>
            <div class="experts-stamp"></div>
          </div>
          <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <!--<div class="separator" style="clear:both;">-->
              <div class="share-site-buttons"></div>
              <ul class="nav navbar-nav navbar-right">
                  <li>
                    <a data-lang="es" href="#/es/">ES</a>
                  </li>
                  <li>
                    <a data-lang="en"href="#/en/">EN</a>
                  </li>
                  <li>
                    <a data-lang="ca" href="#/ca/">CA</a>
                  </li>

                <li class="dropdown">
                 <a href="#" class="logout-button dropdown-toggle" role="button" aria-expanded="false">
                        <i class="glyphicon glyphicon-user"></i><span i18n="header.logout">Logout</span>
                 </a>
                  <a href="#" class="login-button dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
                      <i class="glyphicon glyphicon-user"></i><span i18n="header.login">Login</span>
                  </a>

                  <!--<div id="form-login_" class="dropdown-menu form-login" role="menu">
                    <div class="form-group">
                        <input i18n="header.username|placeholder" type="username" class="form-control" id="login_username" placeholder="Enter email" />
                    </div>
                    <div class="form-group">
                        <input i18n="header.password|placeholder" type="password" class="form-control" id="login_password" placeholder="Password" />
                    </div>
                    <button class="btn btn-success btn-block"><i class="glyphicon glyphicon-ok"></i> <span i18n="header.submit">Submit</span></button>
                  </div>-->
                </li>

              </ul>
            <!--</div>-->
          </div>
        </div>
      </nav>
      <div id="control-login" class="modal fade" role="dialog">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title" i18n="header.login"></h4>
            </div>
            <div class="modal-body content">
              <div id="form-login_" class="form-login" role="menu">
                <div class="form-group">
                    <input i18n="header.username|placeholder" type="username" class="form-control" id="login_username" placeholder="Enter email" />
                </div>
                <div class="form-group">
                    <input i18n="header.password|placeholder" type="password" class="form-control" id="login_password" placeholder="Password" />
                </div>
                <button class="btn btn-success btn-block login-submit"><i class="glyphicon glyphicon-ok"></i> <span i18n="header.submit">Submit</span></button>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
    <div id="map-view" class="container-fullwidth">
        <div id="map-ui" class="map-sidebar"></div>
        <div id="map" class="map"></div>
    </div>
    <!-- Modal -->
    <div id="control-share" class="modal fade" role="dialog">
      <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title" i18n="map.controlshare_share"></h4>
          </div>
          <div class="modal-body content">

          </div>
        </div>

      </div>
    </div>

</div>
<div id="page-reports" class="page">
</div>
    <script type = "text/template" id="content-control-moreinfo-tpl">
        <div>
        <h3 i18n="map.controlmoreinfo_title"></h3>
        <!--<span i18n="map.controlmoreinfo_desc_es"></span>-->
        <ul class="info_list">
            <li class="tiger_mosquito">
                <img src="./img/marker_albopictus_1.svg" class="private">
                <span i18n="layer.tiger" class="bold"></span>:
                <span i18n="expertinfo.tiger_mosquito"></span>
            </li>
            <li class="yellow_fever_mosquito">
                <img src="./img/marker_aegypti_1.svg" class="private">
                <span i18n="layer.zika" class="bold"></span>:
                <span i18n="expertinfo.yellow_fever_mosquito"></span>
            </li>
            <li class="other_species">
                <span i18n="layer.other_species" class="bold"></span>:
                <span i18n="expertinfo.other_species"></span>
            </li>
            <li class="unidentified">
                <span i18n="layer.unidentified" class="bold"></span>:
                <span i18n="expertinfo.unidentify"></span>
            </li>
            <li class="unclassified private">
                <span i18n="layer.unclassified" class="bold"></span>:
                <span i18n="expertinfo.unclassified"></span>
            </li>
            <li class="site">
                <span i18n="layer.site" class="bold"></span>:
                <span i18n="expertinfo.site"></span>
            </li>
            <li class="userfixes">
                <span i18n="layer.userfixes" class="bold"></span>:
                <span i18n="expertinfo.userfixes"></span>
            </li>
            <li class="trash_layer private">
                <span i18n="layer.trash_layer" class="bold"></span>:
                <span i18n="expertinfo.trash_layer"></span>
            </li>
        </ul>
        <p i18n="map.to_know_more"></p>
        <p i18n="map.more_info"></p>
        </div>
    </script>
    <script type = "text/template" id="content-control-share-tpl">
        <div>
        <p i18n="map.controlshare_view_description"></p>
        </div>
        <div>
            <input class="share_input">
        </div>
        <div class="warning"></div>
        <div class="social-butons"></div>
    </script>

    <script type = "text/template" id="content-control-download-tpl">
        <div>
            <h3>
                <span i18n="map.title_download"></span>
            </h3>

            <div id="download_text">
                <span i18n="map.text_description_download"></span>
            </div>
            <div class="download_button">
                <button class="btn btn-success btn-block"><span i18n="map.download_btn"><span></button>
            </div>
        </div>
    </script>

    <script type = "text/template" id="content-control-reportsdocument-tpl">
        <div>
        <h3 i18n="map.controldocumentsreport_title"></h3>
        <span i18n="map.controldocumentsreport_desc"></span>
        <div class="viewreports_button">
            <button id="button-reportsdocument-tpl" class="btn btn-success btn-block" disabled><span i18n="map.viewreports_btn"><span></button>
        </div>
        </div>
    </script>

    <script type = "text/template" id="content-report-tpl">
        <!--<h3 i18n="map.report_title"></h3>-->
        <div id="popup_expert_validated">
            <div class="titol_capa">
                <h3>
                    <div id="validated_specie">
                            <span class="title_validacion_experta" i18n="map.expert_validated"></span>
                            <!-- SI LA VALIDACIÃ“ TE LA PARAULA NONE ES CONSIDERA NO CLASSIFICAT-->
                            <!-- ENCARA QUE TINGUI 0, -1  -2 -->

                            <%if ( expert_validation_result[0]=='none' && expert_validation_result[1]=='-3') { %>
                            <% } else if ( expert_validation_result[0]=='site' && expert_validation_result[1]=='-4') {%>
                                <span class="tolower" i18n="layer.filtered"></span>
                            <% } else { %>
                                <span class="tolower" i18n="layer.<%=category%>"></span>
                            <% } %>
                    </div>
                  </h3>
            </div>

          <% if( ( photo_url != null) && (photo_url != "") ) { %>
              <div id="popup_photo">
                  <a href ="http://webserver.mosquitoalert.com/<%= photo_url %>" target="_blank">
                  <img src="http://webserver.mosquitoalert.com/<%= photo_url %>" onerror="this.style.display = 'none'" />
              </a>
              </div>
              <div class="photo_license">
                  <i>
                    <!-- cal afegir layer trash -->
                    <% if (category != 'not_yet_validated' && category != 'trash_layer' && category != 'breeding_site_not_yet_filtered') { %>
                        <span i18n="report.author"></span>: <span i18n="map.anonim"></span>.
                        <span i18n="report.license"></span><a href="http://www.creativecommons.org/licences/by/4.0/" target="blank">CC by</a> Mosquito Alert
                    <% } %>
                  </i>
              </div>
          <% } %>

          <!-- User Mosquito Answers -->
            <% if (t_answers != null)  { %>
                <div id="popup_mosquito_answers">
                    <div class="one_answer">
                        <!--primera pregunta-->
                        <span class="query"><%=questions[0]%></span>
                        <span class="response"><%=t_answers[0]%></span>
                    </div>
                    <!--Segona pregunta-->
                    <div class="one_answer">
                        <% if ( t_answers.length > 1 ) { %>
                            <span class="query"><%=questions[1]%></span>
                            <span class="response"><%=t_answers[1]%></span>
                        <% } %>
                    </div>
                    <!--tercera pregunta-->
                    <div class="one_answer">
                        <% if ( t_answers.length > 2 ) { %>
                            <span class="query"><%=questions[2]%></span>
                            <span class="response"><%=t_answers[2]%></span>
                        <% } %>
                    </div>

                </div>

            <% } %>
            <!- end mosquito answers-->

            <!-- User breeding site Answers -->
            <% if ( s_answers != null) { %>
                <div id="popup_breeding_site_answers">
                    <div class="one_answer">
                        <span class="query"><%=questions[0]%></span>
                        <span class="response"><%=s_answers[0]%></span>
                    </div>
                    <!--Segona pregunta-->
                    <div class="one_answer">
                        <% if ( s_answers.length > 1 ) { %>
                            <span class="query"><%=questions[1]%></span>
                            <span class="response"><%=s_answers[1]%></span>
                        <% } %>
                    </div>
                    <!--tercera pregunta-->
                    <div class="one_answer">
                        <% if ( s_answers.length > 2 ) { %>
                            <span class="query"><%=questions[2]%></span>
                            <span class="response"><%=s_answers[2]%></span>
                        <% } %>
                    </div>
                    <!--quarta pregunta-->
                    <div class="one_answer">
                        <% if ( s_answers.length > 3 ) { %>
                            <span class="query"><%=questions[2]%></span>
                            <span class="response"><%=s_answers[2]%></span>
                        <% } %>
                    </div>
                </div>
            <% } %> <!-- end user breeding site answers-->


          <% if( (note != null) && (note != '') ) { %>
              <div id="user_note">
                  <span i18n="map.user_note"></span><%= note %>
              </div>
           <% } %>
          <% if( ( edited_user_notes != null) && (edited_user_notes != "") ) { %>
              <div id="nota_experto_reports">
                  <span i18n="map.expert_note"></span><%= edited_user_notes %>
              </div>
           <% } %>
           <% if( ( version_uuid != null) && (version_uuid != "") ) { %>
               <div id="popup_id">
                   <span i18n="map.versio_informe"></span>: <%= version_uuid %>
               </div>

            <% } %>

            <% if( ( observation_date != null) && (observation_date != "") ) { %>
               <div id="popup_observation_date">
                   <span i18n="map.observation_date"></span>: <%= observation_date %>
               </div>
            <% } %>

            <% if( ( lon != null) && (lon != "") && ( lat != null) && (lat != "") ) { %>
               <div id="popup_coordenadas">
                   <span i18n="map.coordenadas"></span>: <%= lat %>, <%= lon %>
               </div>
            <% } %>

      </div>


    </script>

    <script type="text/template" id="content-reportsdocument-tpl">
    <div class="reports_page_title">
        <h2 class="reports" i18n="map.multi_report_title"></h2>
    <div>
        <div class="report_header">
            <div id="reports_header_map">
            </div>
            <div id="legend_reports_map">
                <ul id ="map_layers"></ul>
                <div id="map_filters"></div>
            </div>
        </div>
        <% if (license === true) {%>
            <div id="reports_license_text">
                <div i18n="report.license_text"></div>
        </div>
        <% } %>        
    <%
    counter = 1;
    _.each(rows, function(row) { %>
        <div class="one-report">

            <div  class="one-report-info">
                <div class="report-counter" style=""><%= counter %></div>
                <% ++counter; %>
                <!-- PHOTO & MAP -->
                <div id="photo_and_map">
                    <div class="titol_capa_reports">
                        <h3>
                          <span class="title_validacion_experta" i18n="map.expert_validated"></span>
                          <%if ( row.expert_validation_result[0]=='none' && row.expert_validation_result[1]=='-3') { %>
                          <% } else if ( row.expert_validation_result[0]=='site' && row.expert_validation_result[1]=='-4') {%>
                              <span class="tolower" i18n="layer.filtered"></span>
                          <% } else { %>
                              <span class="tolower" i18n="layer.<%=row.category%>"></span>
                          <% } %>
                        </h3>
                    </div>
                    <div class="one-report-map">
                        <div id="map_report_<%= row.id %>" class="map-report" >
                            <!--#mapa#-->
                        </div>
                    </div>
                    <% if( ( row.photo_url != null) && (row.photo_url != "") ) { %>
                        <div id="photo_reports">
                            <div class="popup_photo_reports">
                                <a href ="http://webserver.mosquitoalert.com/<%= row.photo_url %>" target="_blank">
                                    <img src="http://webserver.mosquitoalert.com/<%= row.photo_url %>" onerror="this.style.display = 'none'" />
                                </a>
                            </div>
                            <div class="photo_license_reports">
                                <i>
                                  <% if (row.category != 'not_yet_validated' && row.category != 'trash_layer' && row.category != 'breeding_site_not_yet_filtered') { %>
                                    <span i18n="report.author"></span>: <span i18n="map.anonim"></span>.<br/>
                                    <span i18n="report.license"></span><a href="http://www.creativecommons.org/licences/by/4.0/" target="blank">CC by</a> Mosquito Alert
                                  <% } %>
                                </i>
                            </div>
                        </div>
                    <% } %>
                </div><!-- photo_and_map-->

                <!-- User Mosquito Answers -->
                  <% if (row.t_answers != null)  { %>
                      <div id="popup_mosquito_answers_reports">
                          <div class="one_answer">
                              <!--primera pregunta-->
                              <span class="query"><%=row.questions[0]%></span>
                              <span class="response"><%=row.t_answers[0]%></span>
                          </div>
                          <!--Segona pregunta-->
                          <div class="one_answer">
                              <% if ( row.t_answers.length > 1 ) { %>
                                  <span class="query"><%=row.questions[1]%></span>
                                  <span class="response"><%=row.t_answers[1]%></span>
                              <% } %>
                          </div>
                          <!--tercera pregunta-->
                          <div class="one_answer">
                              <% if ( row.t_answers.length > 2 ) { %>
                                  <span class="query"><%=row.questions[2]%></span>
                                  <span class="response"><%=row.t_answers[2]%></span>
                              <% } %>
                          </div>

                      </div>

                  <% } %>
                  <!- end mosquito answers-->

                  <!-- User breeding site Answers -->
                  <% if ( row.s_answers != null) { %>
                      <div id="popup_breeding_site_answers_reports">
                          <div class="one_answer">
                              <span class="query"><%=row.questions[0]%></span>
                              <span class="response"><%=row.s_answers[0]%></span>
                          </div>
                          <!--Segona pregunta-->
                          <div class="one_answer">
                              <% if ( row.s_answers.length > 1 ) { %>
                                  <span class="query"><%=row.questions[1]%></span>
                                  <span class="response"><%=row.s_answers[1]%></span>
                              <% } %>
                          </div>
                          <!--tercera pregunta-->
                          <div class="one_answer">
                              <% if ( row.s_answers.length > 2 ) { %>
                                  <span class="query"><%=row.questions[2]%></span>
                                  <span class="response"><%=row.s_answers[2]%></span>
                              <% } %>
                          </div>
                          <!--quarta pregunta-->
                          <div class="one_answer">
                              <% if ( row.s_answers.length > 3 ) { %>
                                  <span class="query"><%=row.questions[2]%></span>
                                  <span class="response"><%=row.s_answers[2]%></span>
                              <% } %>
                          </div>
                      </div>
                  <% } %> <!-- end user breeding site answers-->


                <% if( ( row.note != null) && (row.note != "") ) { %>
                    <div id="user_note">
                        <span i18n="map.user_note"></span><%= row.note %>
                    </div>
                 <% } %>

                <% if( ( row.edited_user_notes != null) && (row.edited_user_notes != "") ) { %>
                    <div id="nota_experto_reports">
                        <span i18n="map.expert_note"></span><%= row.edited_user_notes %>
                    </div>
                 <% } %>

                <% if( ( row.version_uuid != null) && (row.version_uuid != "") ) { %>
                    <div id="popup_id_reports">
                    <span i18n="map.versio_informe"></span>: <%= row.version_uuid %>
                    </div>
                 <% } %>

                 <% if( ( row.observation_date != null) && (row.observation_date != "") ) { %>
                    <div id="popup_observation_date_reports">
                    <span i18n="map.observation_date"></span>: <%= row.observation_date %>
                    </div>
                 <% } %>

                 <% if( ( row.lon != null) && (row.lon != "") && ( row.lat != null) && (row.lat != "") ) { %>
                    <div id="popup_coordenadas_reports">
                    <span i18n="map.coordenadas"></span>: <%= row.lat %>, <%= row.lon %>
                    </div>
                 <% } %>
            </div>
        </div><!--one report-->

    <% }); %>

    </script>


    <!-- build:js js/vendor.min.js -->
    <script src="lib/jquery/dist/jquery.min.js"></script>
    <script src="lib/underscore-min.js"></script>
    <script src="lib/backbone-min.js"></script>

    <script src="lib/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script src="lib/bootstrap-select-1.10.0/dist/js/bootstrap-select.min.js"></script>

    <script src="js/latlon-geohash.js"></script>

    <script src="lib/leaflet/dist/leaflet.js"></script>
    <script src="lib/leaflet.sidebar.js"></script>
    <script src="lib/Leaflet.markercluster-leaflet-0.7/dist/leaflet.markercluster-src.js"></script>
    <script src="lib/Leaflet.CustomButton/L.Control.CustomButton.js"></script>

    <script src="lib/jssocials-1.2.1/jssocials.min.js"></script>

    <!-- endbuild -->

    <!-- build:js js/app.min.js -->
     <!-- inject:js -->
     <script src="js/config.js"></script>
     <script src="js/config_spain.js"></script>
     <script src="js/i18n/ca.js"></script>
     <script src="js/i18n/en.js"></script>
     <script src="js/i18n/es.js"></script>
     <script src="js/i18n/i18n.js"></script>
     <script src="js/leaflet/control-div.js"></script>
     <script src="js/leaflet/control-sidebar-button.js"></script>
     <script src="js/leaflet/control-layers.js"></script>
     <script src="js/leaflet/control-download.js"></script>
     <script src="js/leaflet/control-moreinfo.js"></script>
     <script src="js/leaflet/control-share.js"></script>
     <script src="js/leaflet/control-reportsdocument.js"></script>
     <script src="js/views/base.js"></script>
     <script src="js/views/header.js"></script>
     <script src="js/views/map.js"></script>
     <script src="js/views/map.ui.js"></script>
     <script src="js/views/map.ui.markers.js"></script>
     <script src="js/views/map.layers.js"></script>
     <script src="js/views/reportsdocument.js"></script>
     <script src="js/app.js"></script>

     <!-- endinject -->
    <!-- endbuild -->

</body>
</html>

